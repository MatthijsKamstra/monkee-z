{
"version":3,
"file":"monkee_route.js",
"sourceRoot":"file:///",
"sources":["/Users/matthijskamstra/Documents/GIT/monkee-z/src/MonkeeRoute.hx","/usr/local/lib/haxe/std/haxe/iterators/ArrayIterator.hx"],
"sourcesContent":["package;\n\nimport js.html.svg.Element;\nimport js.Browser.*;\nimport js.html.*;\n\nclass MonkeeRoute {\n\tvar DEBUG = true;\n\n\tvar all = [];\n\n\tpublic function new() {\n\t\tdocument.addEventListener('DOMContentLoaded', (event) -> {\n\t\t\tif (DEBUG)\n\t\t\t\tconsole.info(App.callIn('MonkeeRoute'));\n\t\t\tinit();\n\t\t});\n\t}\n\n\tfunction init() {\n\t\t//  search all element with tag <a>\n\t\tvar arr:Array<Element> = [];\n\t\tarr = cast document.getElementsByTagName('a');\n\t\tfor (i in 0...arr.length) {\n\t\t\tvar a:LinkElement = cast arr[i];\n\t\t\t// trace(a);\n\t\t\ta.onclick = function(e:Event) {\n\t\t\t\te.preventDefault();\n\t\t\t\twindow.fetch(a.href + '.html')\n\t\t\t\t\t.then(response -> response.text())\n\t\t\t\t\t\t// .then(data -> console.log(data))\n\t\t\t\t\t.then(data -> replaceBody(a, data));\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction replaceBody(a:LinkElement, html:String) {\n\t\t// trace(html);\n\t\tvar state = {}; // {'page_id': 1, 'user_id': 5};\n\t\tvar title = '';\n\t\tvar url = ''; // 'hello-world.html';\n\t\twindow.history.pushState(state, title, url);\n\n\t\t// before deleting data from body, store it\n\t\tall = untyped Array.prototype.slice.call(document.body.children);\n\t\t// trace(all);\n\n\t\t// parse elements\n\t\t// document.body.prepend(html);\n\t\t// [mck] replaces everything... not a good idea\n\t\tdocument.body.innerHTML = (html);\n\n\t\tfor (i in 0...all.length) {\n\t\t\tvar el:Element = cast all[i];\n\t\t\ttrace(el);\n\t\t\ttrace(el.localName);\n\t\t\t// for now, put scripts back\n\t\t\tif (el.localName == 'script') {\n\t\t\t\tdocument.body.appendChild(el);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic public function main() {\n\t\tvar app = new MonkeeRoute();\n\t}\n}\n","/*\n * Copyright (C)2005-2018 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.iterators;\n\n/**\n\tThis iterator is used only when `Array<T>` is passed to `Iterable<T>`\n**/\nclass ArrayIterator<T> {\n\tfinal array:Array<T>;\n\tvar current:Int = 0;\n\n\t/**\n\t\tCreate a new `ArrayIterator`.\n\t**/\n\t#if !hl inline #end\n\tpublic function new(array:Array<T>) {\n\t\tthis.array = array;\n\t}\n\n\t/**\n\t\tSee `Iterator.hasNext`\n\t**/\n\t#if !hl inline #end\n\tpublic function hasNext() {\n\t\treturn current < array.length;\n\t}\n\n\t/**\n\t\tSee `Iterator.next`\n\t**/\n\t#if !hl inline #end\n\tpublic function next() {\n\t\treturn array[current++];\n\t}\n}\n"],
"names":[],
"mappings":";;;eAMA;AAAA,EAGW,AAAV,WAAU;AAHX,EACa,AAAZ,aAAY;AADb,EAKC;AALD,EAME,iCAA2B,mBAAmB,gBAAW;AAAA,GACxD,EAAI,eACH;AAAA,yBAAa,qBAAY,gBAAZ;AAAb;AAFuD,GAGxD;AAHwD;AAN3D;QAaiB;AAAA,EAEf,UAAyB;AAFV,EAAhB;AAAgB,EAGf,MAAM,AAAK,qCAA+B;AAH3B,EAIL;AAJK,EAID;AAJC,EAIf,KAAK,CAAK,KAAI,KAAd;AAAA,GAAU;AAAV,GACC,QAAoB,AAAK,IAAI;AAD9B,GAGC,YAAY,YAAkB;AAAA,IAC7B;AAD6B,IAE7B,aAAa,SAAU,cAChB,mBAAY;AAAA;AAAA,YAEZ,eAAQ;AAAA,wBAAY,EAAG;AAAf;AALc;AAH/B;AAJe;qBAiBiC;AAAA,EAEhD,YAAY;AAFoC,EAGhD,YAAY;AAHoC,EAIhD,UAAU;AAJsC,EAKhD,yBAAyB,MAAO,MAAO;AALS,EAQhD,WAAc,2BAA2B;AARO,EAchD,iCAA0B;AAdsB,EAgBtC;AAhBsC,EAgBlC;AAhBkC,EAgBhD,KAAK,CAAK,KAAI,KAAd;AAAA,GAAU;AAAV,GACC,SAAiB,AAAK,SAAI;AAD3B,GAEC,qCAAM;AAFP,GAGC,qCAAM;AAHP,GAKC,EAAI,iBAAiB,UACpB;AAAA,qCAA0B;AAA1B;AANF;AAhBgD;eA4BhD;AAAA,YAAU;AAAV;;;oBCrCF;AAAA,EAEmB,AAAlB,eAAkB;AAFnB,EASE,aAAa;AATf;WAiBE;AAAA,SAAO,eAAU;AAAjB;QAQA;AAAA,SAAO,WAAM;AAAb;;;;;"
}